{% extends "layouts/layout.html" %}
{% block title %}Slit Viewer Simulator{% endblock %}

{% block styles %}
  {{ super() }}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
{% endblock %}

{% block content %}
<div class="container-xxl my-4">

  <!-- 메타 정보 + 상태 배지 -->
  <div class="row align-items-center g-2 mb-2 meta-row">
    <!-- 왼쪽: 파일/메타/좌표 -->
    <div class="col-12 col-lg-6">
      <div class="d-flex flex-wrap gap-3 medium text-muted" style="font-size: 1.2rem;">
        <span>FileName: <span id="fitsFileName">없음</span></span>
        <span>Meta Data: <span id="fitsMeta">없음</span></span>
        <span>Pixel Point: x: <span id="px">-</span>, y: <span id="py">-</span></span>
      </div>
    </div>
    <!-- 오른쪽: 상태 배지 -->
    <div class="col-12 col-lg-6 text-lg-end">
      <span class="status-label">상태:</span>
      <span id="statusBadge"
            class="badge bg-success-subtle text-success border border-success-subtle status-badge">
        준비 완료
      </span>
    </div>
  </div>

  <div class="row g-4">
    <!-- Fits Image View -->
<section class="col-12 col-lg-6">
  <div class="card border-0 shadow-sm h-100 rounded-4">
    <div class="card-header bg-white border-0 pt-4 pb-0">
      <!-- 👇 한 줄 래퍼로 묶기 -->
      <div class="d-flex align-items-center gap-2">
        <span class="badge rounded-pill bg-primary-subtle text-primary border border-primary-subtle">FITS</span>
        <h6 class="fw-semibold mb-0">Fits Image View</h6>
      </div>
      <p class="small text-muted mb-0 mt-2">이미지를 클릭하면 좌표가 표시됩니다.</p>
    </div>
    <div class="card-body">
      <div class="viewer-frame">
        <canvas id="fitsCanvas" class="viewer-canvas"></canvas>
      </div>
    </div>
  </div>
</section>

<!-- Slit Image View -->
<section class="col-12 col-lg-6">
  <div class="card border-0 shadow-sm h-100 rounded-4">
    <div class="card-header bg-white border-0 pt-4 pb-0">
      <!-- 👇 한 줄 래퍼로 묶기 -->
      <div class="d-flex align-items-center gap-2">
        <span class="badge rounded-pill bg-primary-subtle text-primary border border-primary-subtle">SLIT</span>
        <h6 class="fw-semibold mb-0">Slit Image View</h6>
      </div>
      <p class="small text-muted mb-0 mt-2">보정/슬라이스 상태에 따라 슬릿이 갱신됩니다.</p>
    </div>
    <div class="card-body">
      <div class="viewer-frame">
        <canvas id="slitCanvas" class="viewer-canvas"></canvas>
      </div>
    </div>
  </div>
</section>

    <!-- Slit Spectrum -->
    <section class="col-12">
      <div class="card border-0 shadow-sm rounded-4">
        <div class="card-header bg-white border-0 pt-4 pb-0 d-flex align-items-center gap-2">
          <span class="badge rounded-pill bg-primary-subtle text-primary border border-primary-subtle">SPECTRUM</span>
          <h6 class="fw-semibold mb-0">SLIT SPECTRUM</h6>
        </div>
        <div class="card-body">
          <div class="spectrum-frame">
            <canvas id="spectrumCanvas" class="viewer-canvas"></canvas>
          </div>
        </div>
      </div>
    </section>
  </div>
</div>
{% endblock %}

{% block scripts %}
  <!-- 순서 중요: Chart.js → 뷰어 → 헤더 -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" defer></script>
  <script src="{{ url_for('static', filename='js/mainViewer.js') }}" defer></script>
  <script src="{{ url_for('static', filename='js/header.js') }}" defer></script>
{% endblock %}
